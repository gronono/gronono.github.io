<!DOCTYPE html> <html> <head lang="fr"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Gronono | Installer un serveur PXE </title> <meta name="description" content="Un serveur PXE permet de faire un boot d’une machine via le réseau. Pour installer ce serveur, je suis parti d’une debian installé via une netinst sur Virtua..."> <link rel="stylesheet" href="/assets/main.css"> <link rel="canonical" href="http://gronono.github.io/2016/05/install-pxe-server"> <link rel="alternate" type="application/rss+xml" title="Gronono" href="http://gronono.github.io/feed.xml"/> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/brands.css" integrity="sha384-i2PyM6FMpVnxjRPi0KW/xIS7hkeSznkllv+Hx/MtYDaHA5VcF0yL3KVlvzp8bWjQ" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/regular.css" integrity="sha384-hCIN6p9+1T+YkCd3wWjB5yufpReULIPQ21XA/ncf3oZ631q2HEhdC7JgKqbk//4+" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/solid.css" integrity="sha384-ioUrHig76ITq4aEJ67dHzTvqjsAP/7IzgwE7lgJcg2r7BRNGYSK0LwSmROzYtgzs" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/fontawesome.css" integrity="sha384-sri+NftO+0hcisDKgr287Y/1LVnInHJ1l+XC7+FOabmTTIK0HnE2ID+xxvJ21c5J" crossorigin="anonymous"> </head> <body> <div class="header-placeholder"></div> <header class="header"> <div class="wrapper"> <div id="sidebar-toggle">TOC</div> <a class="site-title" href="/">Gronono</a> <nav class="site-nav"> <a class="page-link" href="/">Articles</a> <a class="page-link" href="/archives">Archives</a> <a class="page-link" href="/about">À propos</a> </nav> </div> </header> <div class="page-content"> <div class="wrapper"> <div class="col-main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Installer un serveur PXE</h1> <div class="post-meta"> <span class="date"><i class="far fa-calendar-alt"></i> 10 mai 2016</span> <span class="tags"><i class="fas fa-tags"></i> <a href="/tags/dhcp">dhcp</a> , <a href="/tags/linux">linux</a> , <a href="/tags/pxe">pxe</a> , <a href="/tags/tftp">tftp</a> </span> </div> </header> <article class="post-content"> <p>Un <a href="https://fr.wikipedia.org/wiki/Preboot_Execution_Environment" rel="nofollow noopener">serveur PXE</a> permet de faire un boot d’une machine via le réseau. Pour installer ce serveur, je suis parti d’une <a href="https://www.debian.org/CD/netinst" rel="nofollow noopener">debian installé via une netinst</a> sur <a href="https://www.virtualbox.org/" rel="nofollow noopener">VirtualBox</a>.</p> <h2 id="configuration-du-réseau">Configuration du réseau</h2> <p>Je souhaitais que mon serveur soit accessible sur mon réseau physique. J’ai donc configuré la carte réseau de la machine virtuel en “Accès par pont” pluggué sur ma carte réseau physique.</p> <p>Pour éviter tout soucis, j’ai configuré une IP fixe en éditant le fichier /etc/network/interfaces:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># The primary network interface</span>
auto eth0
iface eth0 inet static
  address 192.168.1.12
  netmask 255.255.255.0
  gateway 192.168.1.1</code></pre></figure> <p>Pour vérifier la configuration un petit ping sur google.fr à partir du serveur et un autre à partir de ma machine vers 192.168.1.12. Tout le monde répond donc la configuration réseau est bonne.</p> <h2 id="serveur-tftp">Serveur TFTP</h2> <p>Un serveur PXE sert les fichiers en <a href="https://fr.wikipedia.org/wiki/Trivial_File_Transfer_Protocol" rel="nofollow noopener">TFTP</a>. J’ai donc installé un serveur TFTP.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get <span class="nb">install </span>atftpd</code></pre></figure> <p>Le répertoire contenant les fichiers par TFTP est définit dans le fichier de conf /etc/default/atftpd. C’est donc /srv/tftp.</p> <h2 id="serveur-dhcp">Serveur DHCP</h2> <p>Pour que le serveur PXE fonctionne correctement, nous devons aussi avoir un serveur DHCP sur votre réseau. Et j’en ai un: mon routeur ADSL fait office de serveur DHCP. Malheureusement, je ne vais pas pouvoir le configurer correctement (comme c’est souvent le cas, les options sont limités sur les serveurs fournis avec les routeurs pour particulier). Je suis donc obligé de le désactiver temporairement et d’en installer un autre sur mon serveur.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get <span class="nb">install </span>isc-dhcp-server</code></pre></figure> <p>La configuration est dans le fichier /etc/dhcp/dhcpd.conf. J’y ai rajouté le bloc:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">subnet 192.168.1.0 netmask 255.255.255.0 <span class="o">{</span>
    range 192.168.1.50 192.168.1.99<span class="p">;</span>
    server-name <span class="s2">"server"</span><span class="p">;</span>
    next-server 192.168.1.12<span class="p">;</span>
    filename <span class="s2">"/srv/tftp/pxelinux.0"</span><span class="p">;</span>
<span class="o">}</span></code></pre></figure> <p>Et j’ai relancé le serveur dhcp:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/init.d/isc-dhcp-server restart</code></pre></figure> <h2 id="le-serveur-pxe">Le serveur PXE</h2> <p>L’installation se fait classiquement:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get <span class="nb">install </span>pxe</code></pre></figure> <p>La configuration est située dans le fichier /etc/pxe.conf. J’ai du changer l’IP d’écoute qui n’était pas bonne - la bonne valeur est l’IP du serveur 192.168.1.12 dans mon cas. J’ai aussi changé le répertoire des fichiers TFTP.</p> <p>Après les modifications de configuration, n’oublions pas de relancer le service</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">/etc/init.d/pxe restart</code></pre></figure> <h2 id="le-test">Le test</h2> <p>Pour essayer, je vais faire en sorte de servir une <a href="https://www.debian.org/index.fr.html" rel="nofollow noopener">Debian</a> via PXE.</p> <p>Et les gars de chez Debian, ils sont sympas, <a href="http://ftp.fr.debian.org/debian/dists/testing/main/installer-amd64/current/images/netboot/netboot.tar.gz" rel="nofollow noopener">ils nous filent directement une archive</a> à décompresser dans le répertoire /srv/tftp.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /srv/tftp
curl http://ftp.fr.debian.org/debian/dists/testing/main/installer-amd64/current/images/netboot/netboot.tar.gz
<span class="nb">tar </span>xvf netboot.tar.gz</code></pre></figure> <p>Lorsqu’on boot une machine sur le réseau, on arrive sur l’assistant d’installation de debian. Donc ça marche \o/</p> <h2 id="conclusion">Conclusion</h2> <p>J’ai connu pire en terme d’installation. Ici ça se passe plutôt bien. Ça m’ennuie un peu d’avoir eu à installer un serveur DHCP car je vais devoir switcher entre les deux suivant si je veux lancer le serveur PXE ou pas. La prochaine étape est l’installation d’un serveur <a href="https://coreos.com/os/docs/latest/booting-with-pxe.html" rel="nofollow noopener">CoreOS via PXE</a>. Mais on en reparle plus tard.</p> </article> <div class="post-comments"> <div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="gronono";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a> </noscript> </div> </div> </div> <div class="col-second"> <div class="col-box col-box-author"> <img class="avatar" src="/assets/profile.jpg" alt="Arnaud Brunet"> <div class="col-box-title name"> <a href="/about">Arnaud Brunet</a> </div> <blockquote> <p><q>La connaissance s'acquiert par l'expérience, tout le reste n'est que de l'information.</q></p> <footer>Albert Einstein</footer> </blockquote> <ul class="contact"> <li> <a title="GitHub" href="https://github.com/gronono" target="_blank"> <i class="fab fa-github"></i> </a> </li> <li> <a title="Stack Overflow" href="https://stackoverflow.com/users/2909535/arnaud" target="_blank"> <i class="fab fa-stack-overflow"></i> </a> </li> <li> <a title="RSS" href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a> </li> </ul> </div> <div class="col-box"> <div class="col-box-title">Articles récents</div> <ul class="post-list"> <li><a class="post-link" href="/2020/08/virtualbox-routeur">Créer une infra virtuelle avec VirtualBox - Partie 1 : le routeur Internet</a></li> <li><a class="post-link" href="/2019/05/docker-proxy-cache">Installer un proxy-cache pour Docker en 2 minutes</a></li> <li><a class="post-link" href="/2019/05/create-jks-from-p7b">Générer un fichier JKS à partir d'une clé privée et d'un fichier P7B</a></li> <li><a class="post-link" href="/2019/05/ohmyzsh_lxc">Auto-complétion de LXC avec Oh-My-Zsh</a></li> <li><a class="post-link" href="/2019/05/apache-loadbalancer">Configurer Apache en mode load balancer</a></li> <li><a class="post-link" href="/2019/05/lxc-expose-port">Exposer un service tournant dans un container LXC</a></li> <li><a class="post-link" href="/2019/05/jekyll">Reprise du blog</a></li> <li><a class="post-link" href="/2016/11/sqlinjection">SQL Injection</a></li> <li><a class="post-link" href="/2016/11/hibernateutils">HibernateUtils</a></li> <li><a class="post-link" href="/2016/05/install-pxe-server">Installer un serveur PXE</a></li> </ul> </div> <div class="col-box"> <div class="col-box-title">Nuage de tags</div> <a href="/tags/java" class="tag tag-3">java</code></a> <a href="/tags/spring" class="tag tag-2">spring</code></a> <a href="/tags/lxc" class="tag tag-2">lxc</code></a> <a href="/tags/linux" class="tag tag-2">linux</code></a> <a href="/tags/virtualbox" class="tag tag-1">virtualbox</code></a> <a href="/tags/tftp" class="tag tag-1">tftp</code></a> <a href="/tags/sql" class="tag tag-1">sql</code></a> <a href="/tags/réseau" class="tag tag-1">réseau</code></a> <a href="/tags/routeur" class="tag tag-1">routeur</code></a> <a href="/tags/pxe" class="tag tag-1">pxe</code></a> <a href="/tags/oh-my-zsh" class="tag tag-1">oh-my-zsh</code></a> <a href="/tags/loadbalancer" class="tag tag-1">loadbalancer</code></a> <a href="/tags/jekyll" class="tag tag-1">jekyll</code></a> <a href="/tags/hibernate" class="tag tag-1">hibernate</code></a> <a href="/tags/docker" class="tag tag-1">docker</code></a> <a href="/tags/dhcp" class="tag tag-1">dhcp</code></a> <a href="/tags/debian" class="tag tag-1">debian</code></a> <a href="/tags/architecture" class="tag tag-1">architecture</code></a> <a href="/tags/apache" class="tag tag-1">apache</code></a> </div> <div class="col-box post-toc hide"> <div class="col-box-title">Sommaire</div> </div> </div> </div> </div> <footer class="footer"> <div class="wrapper"> <a href="/about">&copy; 2020 Arnaud Brunet</a> </div> </footer> <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script> <script src="/assets/easybook.js"></script> </body> </html>