<!DOCTYPE html> <html> <head lang="fr"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Gronono | HibernateUtils </title> <meta name="description" content="Il y a quelques jours je suis tombé sur une classe Java nommée “HibernateUtils”. Il y a quelques points qui ont attiré mon attention et que j’ai envie de par..."> <link rel="stylesheet" href="/assets/main.css"> <link rel="canonical" href="http://gronono.github.io/2016/11/hibernateutils"> <link rel="alternate" type="application/rss+xml" title="Gronono" href="http://gronono.github.io/feed.xml"/> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/brands.css" integrity="sha384-i2PyM6FMpVnxjRPi0KW/xIS7hkeSznkllv+Hx/MtYDaHA5VcF0yL3KVlvzp8bWjQ" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/regular.css" integrity="sha384-hCIN6p9+1T+YkCd3wWjB5yufpReULIPQ21XA/ncf3oZ631q2HEhdC7JgKqbk//4+" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/solid.css" integrity="sha384-ioUrHig76ITq4aEJ67dHzTvqjsAP/7IzgwE7lgJcg2r7BRNGYSK0LwSmROzYtgzs" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/fontawesome.css" integrity="sha384-sri+NftO+0hcisDKgr287Y/1LVnInHJ1l+XC7+FOabmTTIK0HnE2ID+xxvJ21c5J" crossorigin="anonymous"> </head> <body> <div class="header-placeholder"></div> <header class="header"> <div class="wrapper"> <div id="sidebar-toggle">TOC</div> <a class="site-title" href="/">Gronono</a> <nav class="site-nav"> <a class="page-link" href="/">Articles</a> <a class="page-link" href="/archives">Archives</a> <a class="page-link" href="/about">À propos</a> </nav> </div> </header> <div class="page-content"> <div class="wrapper"> <div class="col-main"> <div class="post"> <header class="post-header"> <h1 class="post-title">HibernateUtils</h1> <div class="post-meta"> <span class="date"><i class="far fa-calendar-alt"></i> 28 novembre 2016</span> <span class="tags"><i class="fas fa-tags"></i> <a href="/tags/java">java</a> , <a href="/tags/hibernate">hibernate</a> , <a href="/tags/spring">spring</a> </span> </div> </header> <article class="post-content"> <p>Il y a quelques jours je suis tombé sur une classe Java nommée “HibernateUtils”. Il y a quelques points qui ont attiré mon attention et que j’ai envie de partager avec vous.</p> <p>Avant de commencer voici la classe en question:</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**
 * Classe HibernateUtils.
 *
 * &lt;p&gt;
 * Fournis des méthodes utilitaires de connexion et de gestion de la session
 * d'accès aux données nécessaires à la constitution des éditions.
 * &lt;/p&gt;
 */</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">HibernateUtils</span> <span class="o">{</span>

    <span class="cm">/**
     * The Hibernate session factory.
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="nc">SessionFactory</span> <span class="n">sessionFactory</span><span class="o">;</span>

    <span class="cm">/**
     * The report's data access configuration.
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="nc">Configuration</span> <span class="n">config</span><span class="o">;</span>

    <span class="cm">/**
     * Session thread.
     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">ThreadLocal</span><span class="o">&lt;</span><span class="nc">Session</span><span class="o">&gt;</span> <span class="no">SESSION_LOCALE</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Configuration</span> <span class="nf">getConfiguration</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">config</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">config</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">Configuration</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
     * @param pConfiguration The report JDBC configuration.
     * @return The database Session (opened).
     * @throws HibernateException Usually indicates an invalid configuration or invalid mapping information.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Session</span> <span class="nf">getSession</span><span class="o">(</span><span class="kd">final</span> <span class="nc">JdbcConfiguration</span> <span class="n">pConfiguration</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">HibernateException</span> <span class="o">{</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">getConfiguration</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">platform</span> <span class="o">=</span> <span class="nc">StringUtils</span><span class="o">.</span><span class="na">upperCase</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
        <span class="k">switch</span> <span class="o">(</span><span class="n">platform</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">"MYSQL"</span><span class="o">:</span>
            <span class="n">getMySQLConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"POSTGRESQL"</span><span class="o">:</span>
            <span class="n">getPostgreSQLConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"ORACLE"</span><span class="o">:</span>
            <span class="n">getOracleConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nc">ServiceRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StandardServiceRegistryBuilder</span><span class="o">().</span><span class="na">applySettings</span><span class="o">(</span><span class="n">config</span><span class="o">.</span><span class="na">getProperties</span><span class="o">()).</span><span class="na">build</span><span class="o">();</span>

        <span class="n">sessionFactory</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">buildSessionFactory</span><span class="o">(</span><span class="n">registry</span><span class="o">);</span>
        <span class="no">SESSION_LOCALE</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadLocal</span><span class="o">&lt;</span><span class="nc">Session</span><span class="o">&gt;();</span>
        <span class="nc">Session</span> <span class="n">lSession</span> <span class="o">=</span> <span class="no">SESSION_LOCALE</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
     * Close the session.
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">closeSession</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">SESSION_LOCALE</span><span class="o">.</span><span class="na">get</span><span class="o">().</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
     * constructor intentionally private
     */</span>
    <span class="kd">private</span> <span class="nf">HibernateUtils</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">getMySQLConfig</span><span class="o">(</span><span class="kd">final</span> <span class="nc">JdbcConfiguration</span> <span class="n">pConfiguration</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_DIALECT</span><span class="o">,</span> <span class="s">"org.hibernate.dialect.MySQL5Dialect"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_DRIVER_CLASS</span><span class="o">,</span> <span class="s">"com.mysql.jdbc.Driver"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_URL</span><span class="o">,</span> <span class="s">"jdbc:mysql://"</span>
                  <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getServer</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPort</span><span class="o">()</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getDb</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_USERNAME</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getUser</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_PASSWORD</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>
      <span class="o">}</span>

      <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">getPostgreSQLConfig</span><span class="o">(</span><span class="kd">final</span> <span class="nc">JdbcConfiguration</span> <span class="n">pConfiguration</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_DIALECT</span><span class="o">,</span> <span class="s">"org.hibernate.dialect.PostgreSQLDialect"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_DRIVER_CLASS</span><span class="o">,</span> <span class="s">"org.postgresql.Driver"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_URL</span><span class="o">,</span> <span class="s">"jdbc:postgresql://"</span>
                  <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getServer</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPort</span><span class="o">()</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getDb</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_USERNAME</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getUser</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_PASSWORD</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>
      <span class="o">}</span>

      <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">getOracleConfig</span><span class="o">(</span><span class="kd">final</span> <span class="nc">JdbcConfiguration</span> <span class="n">pConfiguration</span><span class="o">)</span> <span class="o">{</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_DIALECT</span><span class="o">,</span> <span class="s">"org.hibernate.dialect.Oracle10gDialect"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_DRIVER_CLASS</span><span class="o">,</span> <span class="s">"oracle.jdbc.OracleDriver"</span><span class="o">);</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_URL</span><span class="o">,</span> <span class="s">"jdbc:oracle:thin:@"</span>
                  <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getServer</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPort</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getDb</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_USERNAME</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getUser</span><span class="o">());</span>
          <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_PASSWORD</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

      <span class="o">}</span>
<span class="o">}</span></code></pre></figure> <h2 id="classe-utilitaire">Classe utilitaire</h2> <p>La classe se nomme <code class="language-plaintext highlighter-rouge">HibernateUtils</code>, elle est déclarée finale, possède un constructeur privé et toutes ses méthodes sont déclarées statiques. C’est donc bien une classe utilitaire.</p> <p>Globalement je n’aime pas les classes dites utilitaires. Toutes classes d’une application sont utiles sinon on les supprime du projet.</p> <h3 id="état-statique">État statique</h3> <p>Cette classe utilitaire contient un état statique. Et il faut toujours se méfier des états statiques : problèmes de memory leak, de multithreading, …</p> <p>Le développeur utilise judicieusement <code class="language-plaintext highlighter-rouge">ThreadLocal</code> qui lui permet de garbager automatiquement la <code class="language-plaintext highlighter-rouge">Session</code> lorsque le thread se termine et résout le problème du memoryleak et du multithreading en un coup. Mais il reste les références à <code class="language-plaintext highlighter-rouge">SessionFactory</code> et <code class="language-plaintext highlighter-rouge">Configuration</code>.</p> <p>Ils utilisent le mot-clé <code class="language-plaintext highlighter-rouge">volatile</code> alors que <a href="http://www.touilleur-express.fr/2010/12/09/quelle-est-la-difference-entre-volatile-et-synchronized/" rel="nofollow noopener">la plupart des gens ne savent pas ce qu’il signifie</a>. De plus si on veut avoir une instance d’un objet dans un contexte statique et multithreadé, le plus simple est de faire <code class="language-plaintext highlighter-rouge">private static Configuration config = new Configuration();</code> (qu’on peut déclarer maintenant <code class="language-plaintext highlighter-rouge">final</code>).</p> <p>Les subtilités inhérentes à <code class="language-plaintext highlighter-rouge">volatile</code>, <code class="language-plaintext highlighter-rouge">synchronized</code> et le multithreading me font aussi me poser des questions sur le fait que la référence à la <code class="language-plaintext highlighter-rouge">SessionFactory</code> change dans la méthode <code class="language-plaintext highlighter-rouge">getSession(JdbcConfiguration)</code>. Étant donné qu’elle n’est utilisée que dans cette méthode, n’aurait-il pas été plus simple d’en faire une variable locale ?</p> <h3 id="fourre-tout">Fourre-tout</h3> <p>Une classe suffixée par <code class="language-plaintext highlighter-rouge">Utils</code> est l’occasion d’avoir un fourre-tout sans avoir de notion (métier ou technique) clairement définie derrière. On se retrouve souvent à avoir des classes qui grossissent à n’en plus finir, contiennent finalement des méthodes qui n’ont plus rien à voir entre elles et qui ne sont appelées qu’une seule fois. <strong>Les classes utilitaires ne devraient exister que pour enrichir le langage.</strong></p> <p>Si on regarde l’utilisation de cette classe dans le projet, on s’aperçoit :</p> <ol> <li>la méthode <code class="language-plaintext highlighter-rouge">getConfiguration()</code> n’est pas appelée en dehors de cette classe : on peut la passer en <code class="language-plaintext highlighter-rouge">private</code>,</li> <li>la méthode <code class="language-plaintext highlighter-rouge">closeSession()</code> n’est jamais appelée dans toute l’application : on peut la supprimer,</li> <li>cette classe sert à vérifier que les paramètres de connexion fournis sont corrects (ping sur la base),</li> <li>à récupérer une connexion à la base de données</li> </ol> <p>Le fait que la méthode <code class="language-plaintext highlighter-rouge">closeSession()</code> ne soit jamais appelée me semble complètement anormale. Est-ce que ça signifie que les sessions obtenues par <code class="language-plaintext highlighter-rouge">getSession(JdbcConfiguration)</code> ne sont jamais fermées ?</p> <p>Finalement le besoin ici n’est pas d’avoir un fourre-tout par rapport à <code class="language-plaintext highlighter-rouge">Hibernate</code> mais d’avoir un mécanisme manipulant les connexions à la base. On pourrait donc écrire une interface décrivant ce service, par exemple :</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DatabaseService</span> <span class="o">{</span>

	<span class="cm">/**
	 * Effectue un ping vers la base de données.
	 * C'est à dire vérifie que les paramètres de connexion spécifiés sont corrects.
	 *
	 * @param jdbcConfiguration Les paramètres de connexion à la base de données.
   * @return true si le ping est correct, false sinon
	 */</span>
	<span class="kt">boolean</span> <span class="nf">ping</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">);</span>

	<span class="cm">/**
	 * Permet de récupérer une connexion à la base de données.
	 * &lt;em&gt;Attention:&lt;/em&gt;Vous devez fermer la connexion après usage.
	 *
	 * @param jdbcConfiguration Les paramètres de connexion à la base de données.
	 * @return La connexion.
	 */</span>
	<span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure> <p>Je propose une implémentation plus loin du service. Mais à ce stade, il n’est pas difficile de faire une implémentation se reposant sur <code class="language-plaintext highlighter-rouge">Hibernate</code> en reprenant le code de la classe <code class="language-plaintext highlighter-rouge">HibernateUtils</code>.</p> <h2 id="switchcase">Switch/case</h2> <p>Maintenant qu’on a fini avec le statut ‘<code class="language-plaintext highlighter-rouge">Utils</code>’ de la classe , il est temps d’examiner un peu le contenu de la classe.</p> <p>Comme nous l’avons vu le cœur de la classe est la méthode <code class="language-plaintext highlighter-rouge">getSession(JdbcConfiguration)</code>. Et elle contient un <code class="language-plaintext highlighter-rouge">switch</code>/<code class="language-plaintext highlighter-rouge">case</code> me posant plusieurs problèmes.</p> <h3 id="cas-par-défaut">Cas par défaut</h3> <p>Dans un <code class="language-plaintext highlighter-rouge">switch</code>/<code class="language-plaintext highlighter-rouge">case</code>, il faut toujours utiliser <code class="language-plaintext highlighter-rouge">default</code>. Et l’auteur y a pensé, mais il n’y fait absolument rien ! Que se passe-t-il si la plateforme n’est pas supportée ? On se retrouve avec une configuration non initialisée et Hibernate va planter avec une erreur potentiellement obscure. Il aurait été beaucoup plus explicite de mettre un <code class="language-plaintext highlighter-rouge">throw UnsupportedOperationException("unsupported platform: " + platform );</code> ou équivalent. Ça peut sauver pas mal de santé mentale à celui qui tombe sur l’erreur.</p> <h3 id="switch-sur-des-chaînes">Switch sur des chaînes</h3> <p>C’est une fonctionnalité apparue avec Java 7. Comme vous en doutez sûrement, je ne suis pas fan. Surtout qu’ici le nombre de possibilités est fini et connu au moment de la compilation : pour ajouter une plateforme, il faut nécessairement modifier le code (au moins ajouter la dépendance vers le driver). Donc je pense que ça aurait été une meilleure idée de passer par une énumération. Et comme la bonne pratique veut qu’on convertisse les valeurs le plus tôt possible, on peut avoir :</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">DatabasePlatform</span> <span class="o">{</span>
	<span class="no">MYSQL</span><span class="o">,</span> <span class="no">POSTGRESQL</span><span class="o">,</span> <span class="no">ORACLE</span>
<span class="o">}</span></code></pre></figure> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// pConfiguration possède déjà la version convertie.</span>
<span class="nc">DatabasePlatform</span> <span class="n">platform</span> <span class="o">=</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>
<span class="nc">Configuration</span> <span class="n">config</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="k">switch</span> <span class="o">(</span><span class="n">platform</span><span class="o">)</span> <span class="o">{</span>
<span class="k">case</span> <span class="nl">MYSQL:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">getMySQLConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
    <span class="k">break</span><span class="o">;</span>
<span class="k">case</span> <span class="nl">POSTGRESQL:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">getPostgreSQLConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
    <span class="k">break</span><span class="o">;</span>
<span class="k">case</span> <span class="nl">ORACLE:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">getOracleConfig</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">);</span>
    <span class="k">break</span><span class="o">;</span>
<span class="k">default</span><span class="o">:</span>
	<span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedOperationException</span><span class="o">(</span><span class="s">"unsupported platform: "</span> <span class="o">+</span> <span class="n">platform</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure> <h3 id="logique-dupliquée">Logique dupliquée</h3> <p>Les trois <code class="language-plaintext highlighter-rouge">case</code> appellent quasiment les mêmes méthodes dans lesquelles on initialise le login et le mot de passe de façon commune et le dialecte, le driver et l’url spécifique à la base de données. Maintenant qu’on a une classe d’énumération, on peut facilement stocker les informations spécifiques à la base dans l’enum. Il y a juste un peu problème avec l’url qu’on peut résoudre (par exemple) avec du remplacement de wildcard.</p> <p>L’énumération devient:</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">DatabasePlatform</span> <span class="o">{</span>
  <span class="no">MYSQL</span><span class="o">(</span><span class="nc">MySQL5Dialect</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">com</span><span class="o">.</span><span class="na">mysql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">Driver</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"jdbc:mysql://${server}:${port}/${instance}"</span><span class="o">),</span>
  <span class="no">POSTGRESQL</span><span class="o">(</span><span class="nc">PostgreSQLDialect</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">Driver</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"jdbc:postgresql://${server}:${port}/${instance}"</span><span class="o">),</span>
  <span class="no">ORACLE</span><span class="o">(</span><span class="nc">Oracle10gDialect</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">oracle</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">OracleDriver</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"jdbc:oracle:thin:@${server}:${port}:${instance}"</span><span class="o">);</span>

  <span class="kd">private</span> <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Dialect</span><span class="o">&gt;</span> <span class="n">dialect</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Driver</span><span class="o">&gt;</span> <span class="n">driver</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">url</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nf">DatabasePlatform</span><span class="o">(</span><span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Dialect</span><span class="o">&gt;</span> <span class="n">dialect</span><span class="o">,</span> <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Driver</span><span class="o">&gt;</span> <span class="n">driver</span><span class="o">,</span> <span class="nc">String</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">dialect</span> <span class="o">=</span> <span class="n">dialect</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Dialect</span><span class="o">&gt;</span> <span class="nf">getDialect</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">dialect</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Driver</span><span class="o">&gt;</span> <span class="nf">getDriver</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">driver</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUrl</span><span class="o">(</span><span class="nc">String</span> <span class="n">server</span><span class="o">,</span> <span class="nc">String</span> <span class="n">port</span><span class="o">,</span> <span class="nc">String</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">url</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${server}"</span><span class="o">,</span> <span class="n">server</span><span class="o">)</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${port}"</span><span class="o">,</span> <span class="n">port</span><span class="o">)</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${instance}"</span><span class="o">,</span> <span class="n">instance</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure> <p>Et la méthode <code class="language-plaintext highlighter-rouge">getSession(JdbcConfiguration)</code>:</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="nc">Session</span> <span class="nf">getSession</span><span class="o">(</span><span class="kd">final</span> <span class="nc">JdbcConfiguration</span> <span class="n">pConfiguration</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">HibernateException</span> <span class="o">{</span>
  <span class="nc">DatabasePlatform</span> <span class="n">platform</span> <span class="o">=</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>
  <span class="nc">Configuration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Configuration</span><span class="o">();</span>
  <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_DIALECT</span><span class="o">,</span> <span class="n">platform</span><span class="o">.</span><span class="na">getDialect</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
  <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_DRIVER_CLASS</span><span class="o">,</span> <span class="n">platform</span><span class="o">.</span><span class="na">getDriver</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
  <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_URL</span><span class="o">,</span> <span class="n">platform</span><span class="o">.</span><span class="na">getUrl</span><span class="o">(</span><span class="n">pConfiguration</span><span class="o">.</span><span class="na">getServer</span><span class="o">(),</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPort</span><span class="o">(),</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getDb</span><span class="o">()));</span>
  <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_USERNAME</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getUser</span><span class="o">());</span>
  <span class="n">config</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="nc">HibernateConfigProperty</span><span class="o">.</span><span class="na">HIBERNATE_CONNECTION_PASSWORD</span><span class="o">,</span> <span class="n">pConfiguration</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

  <span class="nc">ServiceRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StandardServiceRegistryBuilder</span><span class="o">().</span><span class="na">applySettings</span><span class="o">(</span><span class="n">config</span><span class="o">.</span><span class="na">getProperties</span><span class="o">()).</span><span class="na">build</span><span class="o">();</span>
  <span class="nc">SessionFactory</span> <span class="n">sessionFactory</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">buildSessionFactory</span><span class="o">(</span><span class="n">registry</span><span class="o">);</span>
  <span class="k">return</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure> <p>On a supprimé la logique dupliquée, centralisé la gestion des drivers <code class="language-plaintext highlighter-rouge">JDBC</code> et on a maintenant une vérification de type sûr - les classes des dialectes et des drivers sont vérifiées à la compilation. Et effet de bord non voulu, mon IDE m’a remonté que la classe utilisée pour le driver postgresql est dépréciée.</p> <h2 id="couplage-avec-hibernate">Couplage avec Hibernate</h2> <p>Jusque-là j’ai gardé le fait que le développeur est utilisé <code class="language-plaintext highlighter-rouge">Hibernate</code> pour remplir ses deux besoins : faire un ping de la base et obtenir une connexion. Mais l’application en question est une application <code class="language-plaintext highlighter-rouge">spring-boot</code> utilisant <code class="language-plaintext highlighter-rouge">spring-data-jpa</code>. Donc <code class="language-plaintext highlighter-rouge">hibernate</code> est une dépendance indirecte fournie par Spring. Et si les gars de <code class="language-plaintext highlighter-rouge">spring-data-jpa</code> décident de changer l’implémentation JPA par défaut par autre chose qu’Hibernate il faudra revoir cette classe (ou introduire directement la dépendance, ce qui peut avoir des effets bords inattendus du à plusieurs implémentations de JPA dans le classpath).</p> <p>De plus utiliser Hibernate pour un besoin aussi trivial revient à sortir une usine à gaz pour pas grand-chose, en ajoutant les problèmes liés à la gestion des sessions dans Hibernate inutile à notre cas.</p> <p>En supprimant le couplage avec Hibernate, mais en gardant celui avec Spring (qui te toute façon sera non triviale à supprimer par l’intrusivité du framework), on a :</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringDatabaseService</span> <span class="kd">implements</span> <span class="nc">DatabaseService</span> <span class="o">{</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">ping</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="k">return</span> <span class="nf">getConnection</span><span class="o">(</span><span class="n">jdbcConfiguration</span><span class="o">).</span><span class="na">isValid</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// Une implémentation plus judicieuse remonterait la cause</span>
			<span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">DatabasePlatform</span> <span class="n">platform</span> <span class="o">=</span> <span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getType</span><span class="o">();</span>
		<span class="nc">DataSource</span> <span class="n">ds</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDriverDataSource</span><span class="o">(</span>
				<span class="n">platform</span><span class="o">.</span><span class="na">getDriver</span><span class="o">(),</span>
				<span class="n">platform</span><span class="o">.</span><span class="na">getUrl</span><span class="o">(</span><span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getServer</span><span class="o">(),</span> <span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getPort</span><span class="o">(),</span> <span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getDb</span><span class="o">()),</span>
				<span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getUser</span><span class="o">(),</span>
				<span class="n">jdbcConfiguration</span><span class="o">.</span><span class="na">getPassword</span><span class="o">());</span>

		<span class="k">try</span> <span class="o">{</span>
			<span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SQLException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// Bien évidement, ici il faut propager l'exception</span>
			<span class="c1">// avec probablement une meilleur exception que RuntimeException</span>
			<span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></figure> <p>Avec l’enum qui va bien (on a enlevé le dialecte):</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">DatabasePlatform</span> <span class="o">{</span>
  <span class="no">MYSQL</span><span class="o">(</span><span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">mysql</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">Driver</span><span class="o">(),</span> <span class="s">"jdbc:mysql://${server}:${port}/${instance}"</span><span class="o">),</span>
  <span class="no">POSTGRESQL</span><span class="o">(</span><span class="k">new</span> <span class="n">org</span><span class="o">.</span><span class="na">postgresql</span><span class="o">.</span><span class="na">Driver</span><span class="o">(),</span> <span class="s">"jdbc:postgresql://${server}:${port}/${instance}"</span><span class="o">),</span>
  <span class="no">ORACLE</span><span class="o">(</span><span class="k">new</span> <span class="n">oracle</span><span class="o">.</span><span class="na">jdbc</span><span class="o">.</span><span class="na">OracleDriver</span><span class="o">(),</span> <span class="s">"jdbc:oracle:thin:@${server}:${port}:${instance}"</span><span class="o">);</span>

  <span class="kd">private</span> <span class="nc">Driver</span> <span class="n">driver</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">url</span><span class="o">;</span>

  <span class="kd">private</span> <span class="nf">DatabasePlatform</span><span class="o">(</span><span class="nc">Driver</span> <span class="n">driver</span><span class="o">,</span> <span class="nc">String</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">Driver</span> <span class="nf">getDriver</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">driver</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUrl</span><span class="o">(</span><span class="nc">String</span> <span class="n">server</span><span class="o">,</span> <span class="nc">String</span> <span class="n">port</span><span class="o">,</span> <span class="nc">String</span> <span class="n">instance</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">url</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${server}"</span><span class="o">,</span> <span class="n">server</span><span class="o">)</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${port}"</span><span class="o">,</span> <span class="n">port</span><span class="o">)</span>
        <span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"${instance}"</span><span class="o">,</span> <span class="n">instance</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure> <h2 id="fermeture-automatique">Fermeture automatique</h2> <p>Il reste un dernier petit détail. Le développeur doit toujours penser à fermer la connexion lorsqu’il appelle <code class="language-plaintext highlighter-rouge">getConnection(JdbcConfiguration)</code> et on peut y remédier si c’est nous qui contrôlons la fermeture. Exemple (en java 8):</p> <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doInConnection</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">,</span> <span class="nc">Consumer</span><span class="o">&lt;</span><span class="nc">Connection</span><span class="o">&gt;</span> <span class="n">consumer</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">try</span> <span class="o">(</span><span class="nc">Connection</span> <span class="n">cnx</span> <span class="o">=</span> <span class="n">getConnection</span><span class="o">(</span><span class="n">jdbcConfiguration</span><span class="o">))</span> <span class="o">{</span>
		<span class="n">consumer</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">cnx</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="nc">Connection</span> <span class="nf">getConnection</span><span class="o">(</span><span class="nc">JdbcConfiguration</span> <span class="n">jdbcConfiguration</span><span class="o">)</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span></code></pre></figure> <p>L’idée est la suivante: on n’expose plus la méthode <code class="language-plaintext highlighter-rouge">getConnection(JdbcConfiguration)</code> et à la place, on fournit une méthode qui prend le traitement à faire avec la connexion <code class="language-plaintext highlighter-rouge">Consumer&lt;Connection&gt;</code>. Ainsi on peut ouvrir la connexion, faire le traitement et fermer la connexion. Ainsi on évite les fuites parce que l’appelant à oublier de fermer la connexion.</p> <h2 id="conclusion">Conclusion</h2> <p>Pour résumer on a simplifié le code :</p> <ul> <li>en supprimant les problèmes liés au multithreading,</li> <li>en rajoutant des notions de plus haut niveau (DatabaseService vs HibernateUtils),</li> <li>en découplant la notion de service et son implémentation</li> <li>en factorisant la gestion des drivers en un endroit unique</li> <li>en supprimant un framework compliqué : Hibernate,</li> <li>en forçant la fermeture des connexions.</li> </ul> <p>J’espère que cet article vous aura plu. N’hésitez pas à commenter ci-dessous si vous d’accord ou pas.</p> </article> <div class="post-comments"> <div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="gronono";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a> </noscript> </div> </div> </div> <div class="col-second"> <div class="col-box col-box-author"> <img class="avatar" src="/assets/profile.jpg" alt="Arnaud Brunet"> <div class="col-box-title name"> <a href="/about">Arnaud Brunet</a> </div> <blockquote> <p><q>La connaissance s'acquiert par l'expérience, tout le reste n'est que de l'information.</q></p> <footer>Albert Einstein</footer> </blockquote> <ul class="contact"> <li> <a title="GitHub" href="https://github.com/gronono" target="_blank"> <i class="fab fa-github"></i> </a> </li> <li> <a title="Stack Overflow" href="https://stackoverflow.com/users/2909535/arnaud" target="_blank"> <i class="fab fa-stack-overflow"></i> </a> </li> <li> <a title="RSS" href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a> </li> </ul> </div> <div class="col-box"> <div class="col-box-title">Articles récents</div> <ul class="post-list"> <li><a class="post-link" href="/2020/08/virtualbox-routeur">Créer une infra virtuelle avec VirtualBox - Partie 1 : le routeur Internet</a></li> <li><a class="post-link" href="/2019/05/docker-proxy-cache">Installer un proxy-cache pour Docker en 2 minutes</a></li> <li><a class="post-link" href="/2019/05/create-jks-from-p7b">Générer un fichier JKS à partir d'une clé privée et d'un fichier P7B</a></li> <li><a class="post-link" href="/2019/05/ohmyzsh_lxc">Auto-complétion de LXC avec Oh-My-Zsh</a></li> <li><a class="post-link" href="/2019/05/apache-loadbalancer">Configurer Apache en mode load balancer</a></li> <li><a class="post-link" href="/2019/05/lxc-expose-port">Exposer un service tournant dans un container LXC</a></li> <li><a class="post-link" href="/2019/05/jekyll">Reprise du blog</a></li> <li><a class="post-link" href="/2016/11/sqlinjection">SQL Injection</a></li> <li><a class="post-link" href="/2016/11/hibernateutils">HibernateUtils</a></li> <li><a class="post-link" href="/2016/05/install-pxe-server">Installer un serveur PXE</a></li> </ul> </div> <div class="col-box"> <div class="col-box-title">Nuage de tags</div> <a href="/tags/java" class="tag tag-3">java</code></a> <a href="/tags/spring" class="tag tag-2">spring</code></a> <a href="/tags/lxc" class="tag tag-2">lxc</code></a> <a href="/tags/linux" class="tag tag-2">linux</code></a> <a href="/tags/virtualbox" class="tag tag-1">virtualbox</code></a> <a href="/tags/tftp" class="tag tag-1">tftp</code></a> <a href="/tags/sql" class="tag tag-1">sql</code></a> <a href="/tags/réseau" class="tag tag-1">réseau</code></a> <a href="/tags/routeur" class="tag tag-1">routeur</code></a> <a href="/tags/pxe" class="tag tag-1">pxe</code></a> <a href="/tags/oh-my-zsh" class="tag tag-1">oh-my-zsh</code></a> <a href="/tags/loadbalancer" class="tag tag-1">loadbalancer</code></a> <a href="/tags/jekyll" class="tag tag-1">jekyll</code></a> <a href="/tags/hibernate" class="tag tag-1">hibernate</code></a> <a href="/tags/docker" class="tag tag-1">docker</code></a> <a href="/tags/dhcp" class="tag tag-1">dhcp</code></a> <a href="/tags/debian" class="tag tag-1">debian</code></a> <a href="/tags/architecture" class="tag tag-1">architecture</code></a> <a href="/tags/apache" class="tag tag-1">apache</code></a> </div> <div class="col-box post-toc hide"> <div class="col-box-title">Sommaire</div> </div> </div> </div> </div> <footer class="footer"> <div class="wrapper"> <a href="/about">&copy; 2020 Arnaud Brunet</a> </div> </footer> <script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script> <script src="/assets/easybook.js"></script> </body> </html>