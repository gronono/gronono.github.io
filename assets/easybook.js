/*!
 * EasyBook Jekyll Theme Javascript
 * 
 * http://laobubu.github.io/jekyll-theme-EasyBook
 * https://github.com/laobubu/jekyll-theme-EasyBook
 *
 * This is just a extension for my theme.
 */
function TOCize(l,e,d){function i(e,t,n){var i=e.getBoundingClientRect().top+a.getTop();if(window.history.pushState)window.history.pushState({},e.textContent,"#"+t),a.to(i),n.preventDefault();else{var o=a.getTop();setTimeout(function(){a.setTop(o),a.to(i)},0)}}if(!(l&&e&&d))return!1;for(var o=0,r=function(e){return document.createElement(e)},a={to:function(e){a.target=e,a.running||(a.running=setInterval(a.tick,20))},target:0,running:0,getTop:function(){return window.scrollY||window.pageYOffset||document.documentElement.scrollTop},setTop:function(e){window.scrollTo&&window.scrollTo(window.scrollX,e)},tick:function(){var e=~~((a.getTop()+a.target)/2);a.setTop(e),(a.getTop()<e||Math.abs(e-a.target)<10)&&(a.setTop(a.target),clearInterval(a.running),a.running=0)}},t=function(e){var t=r("a");o++;var n=e.getAttribute("id");return n||(n="generated-hash-"+o,e.setAttribute("id",n)),t.textContent=e.textContent,t.setAttribute("href","#"+n),t.addEventListener("click",i.bind(this,e,n),!1),t},n=e.querySelectorAll("h1, h2, h3, h4, h5, h6"),c=1,s=[r("ul")],u=0;u<n.length;u++){var p=+n[u].tagName.substr(1),h=n[u],m=r("li");if(m.appendChild(t(h)),c<p)for(;s.push(r("ul")),s[s.length-2].appendChild(s[s.length-1]),++c<p;);else if(p<c)for(;s.pop(),--c>p;);s[s.length-1].appendChild(m)}for(;;){var g=s[0].children;if(1!=g.length||"UL"!=g[0].tagName)break;s.shift()}if(!o)return!1;var f=r("div");l.appendChild(f),l.appendChild(s[0]),l.style.display="block";var v="",y=(document.querySelector(".col-main"),document.querySelector(".header-placeholder")),w=function(){a.getTop();var e,t,n=f.getBoundingClientRect().top-y.offsetHeight,i=10;if((e=-n+i)<0&&(e=0),e){var o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=d.getBoundingClientRect().bottom-n-s[0].offsetHeight;r<e&&(e=r),t=o-(i<<1)+"px"}else t="";t!=v&&((v=t)?s[0].setAttribute("style","max-height:"+t+"; width:"+(l.offsetWidth-20)+"px"):s[0].setAttribute("style","")),f.style.height=e+"px"};window.addEventListener("scroll",w,!1),window.addEventListener("resize",w,!1)}function PalmSidebar(){function e(){window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var e=i.getBoundingClientRect();r="static"!==getComputedStyle(i).position,o.style.height=r?e.bottom-e.top+"px":"0px"}function t(){/expand-sidebar/.test(n.className)?(n.className=n.className.replace(/\s*expand-sidebar\s*/," "),i.className=i.className.replace(/\s*expand-sidebar\s*/," ")):(n.className+=" expand-sidebar",i.className+=" expand-sidebar"),setTimeout(e,200)}var n=document.querySelector(".page-content .wrapper"),i=document.querySelector(".header"),o=document.querySelector(".header-placeholder"),r=!1;"function"==typeof window.getComputedStyle&&(e(),document.getElementById("sidebar-toggle").addEventListener("click",t,!1),window.addEventListener("resize",e,!1))}function SelectAllize(e,t){function n(){d.classList.add("hidden"),d.style.top="-200px"}function i(e){if(l.isCollapsed){var t=e.pageY-d.offsetHeight-15;d.setAttribute("style","left:"+(e.pageX-d.offsetWidth/2)+"px;top:"+(t+10)+"px"),d.classList.remove("hidden"),setTimeout(n,1e3)}}function o(){l.selectAllChildren(this),n()}if(!window.getSelection)return null;var r=document.querySelectorAll(e),l=window.getSelection(),d=document.createElement("div");d.className="util-notify1",d.textContent=t,document.body.appendChild(d),n(),d.addEventListener("mouseover",n,!1);for(var a=r.length;a--;){var c=r[a];c.addEventListener("click",i,!1),c.addEventListener("dblclick",o,!1)}return!0}function RealLoad(){TOCize(document.querySelector(".post-toc"),document.querySelector(".post-content"),document.querySelector(".col-main")),PalmSidebar(),SelectAllize("pre.highlight","Dblclick to select all");for(var e=document.querySelectorAll(".post-content > p > img"),t=e.length;t--;)1===e[t].parentElement.childNodes.length&&e[t].classList.add("middle-image");if(document.querySelector('script[type*="math/tex"]')){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("async","true"),n.setAttribute("src","https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"),document.body.appendChild(n)}}RealLoad();